{% comment %}Reusable Invoice action buttons: Preview, View, Edit, Download{% endcomment %}
{% load tz %}
{# Container supports inline use and mobile stacking via CSS below #}
<style>
  /* Ensure these action groups stack nicely on small screens */
  @media(max-width:767px){
    .invoice-actions { display:block !important; }
    .invoice-actions .btn { display:block !important; width:100% !important; margin-bottom:.375rem !important; }
    .invoice-actions .btn:last-child { margin-bottom:0 !important; }
  }
  /* Keep compact inline grouping on larger screens */
  .invoice-actions { display:inline-flex; gap:.375rem; flex-wrap:wrap; align-items:center; }
  /* Normalize button sizing so all action buttons share size and alignment */
  .invoice-actions .btn { min-width:110px; height:38px; display:inline-flex; align-items:center; justify-content:center; }
  .invoice-actions .btn .me-1 { margin-right:8px; }
</style>

{# Parameters: show_actions (default True), show_preview (default True), show_view (default True) #}

{% if invoice and invoice.pk and show_actions|default:True %}
<div class="invoice-actions" role="group" aria-label="Invoice actions">
  {# Download button (replaces preview in list views) #}
  <a href="{% url 'generate_pdf' invoice.pk %}?format=pdf&template={{ invoice.template_choice|default:'1' }}" class="btn btn-sm btn-success" target="_blank" rel="noopener noreferrer">
    <i class="fas fa-file-pdf me-1"></i> Download
  </a>

  {% if show_view|default:True %}
  <a href="{% url 'invoice_detail' invoice.pk %}" class="btn btn-sm btn-outline-secondary">
    <i class="fas fa-file-alt me-1"></i> View
  </a>
  {% endif %}

  <a href="{% url 'invoice_edit' invoice.pk %}" class="btn btn-sm btn-primary">
    <i class="fas fa-edit me-1"></i> Edit
  </a>
</div>
{% elif show_actions|default:True %}
<div class="invoice-actions" role="group" aria-label="Invoice actions">
  {# Create page: open live preview modal #}
  <button type="button" class="btn btn-sm btn-outline-primary" id="live-pdf-preview-btn" data-bs-toggle="modal" data-bs-target="#invoice-preview-modal">
    <i class="fas fa-eye me-1"></i> Preview
  </button>
  {# Keep download available on create page if desired (wired elsewhere) #}
  <button type="button" class="btn btn-sm btn-outline-success" id="create-download-pdf-btn">Download</button>
</div>
{% endif %}

{# Flags defaulted via the |default filter above; no trailing endwith blocks needed #}
